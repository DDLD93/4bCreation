<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate of Completion</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Open+Sans:wght@300;400;600&display=swap');
        
        @font-face {
            font-family: 'Times';
            src: url('times-font.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        .certificate {
            width: 794px;
            height: 1123px;
            background-image: url('<%= background %>');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            /* A4 dimensions: 210mm × 297mm = 794px × 1123px at 96 DPI */
            /* Ensure background image is preserved */
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            color-adjust: exact;
        }
        .name{
            font-size: 40px;
            font-weight: 700;
            font-family: 'Times', serif;
            color: #000;
            position: absolute;
            top: 460px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        /* Print styles for A4 */
        @media print {
            body {
                margin: 0;
                padding: 0;
                background: none;
            }
            
            .certificate {
                width: 210mm;
                height: 297mm;
                margin: 0;
                padding: 0;
                box-shadow: none;
                page-break-after: always;
                /* Ensure background image shows in print */
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                color-adjust: exact;
                background-image: url('<%= background %>') !important;
                background-size: cover !important;
                background-position: center !important;
                background-repeat: no-repeat !important;
            }
        }
        
        /* A4 size validation */
        @media screen {
            .certificate {
                /* Ensure exact A4 proportions on screen */
                aspect-ratio: 210 / 297;
            }
        }
    </style>
</head>
<body>
    <div class="certificate">
        <p class="name"><%= name %></p>
    </div>
</body>
</html>
